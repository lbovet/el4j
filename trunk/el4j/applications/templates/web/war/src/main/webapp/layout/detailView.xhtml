<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                             "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:el4j="http://www.elca.ch/el4j/taglib">
	
	<ui:remove><!--
	
		Detail View Parameters (all are optional, if not set they are derived from pageId)
		======================
		String values:
			entityShortName : short name of entity (see ch.elca.el4j.seam.generic.EntityShortNameMapping)
			entityClassName : fully qualified class name
			masterPage      : pageId of corresponding master page
			
		Component fragments:
			fields          : the region containing all fields
			crudBar         : a set of buttons (e.g. save, delete etc.)
			customMapping   : a mapping of fieldName (or fieldType) to JSF components
			                  (see entityTest.xhtml for an example)
			customRemark    : the region behind each edit field
		
	--></ui:remove>

	<ui:remove><!-- assign values to JSF variables --></ui:remove>
	<c:if test="#{empty entityShortName}">
		<el4j:set var="entityShortName"
			value="#{utils.deriveEntityShortName()}" />
	</c:if>

	<el4j:set var="entityClassName"
		value="#{utils.getEntityClassName(entityShortName)}" />

	<c:if test="#{empty title}">
		<el4j:set var="title" value="#{el4j:h10nEntityName(entityShortName)}" />
	</c:if>

	<c:if test="#{empty masterPage}">
		<el4j:set var="masterPage"
			value="#{utils.getDefaultMasterPage(entityShortName)}" />
	</c:if>

	<h:messages globalOnly="true" styleClass="message" />

    <ui:include src="/WEB-INF/facelet/modalPanel.xhtml" >
        
        <c:set var="panelTitle" value="#{title}" />
    
    
        <!-- the text to display in the help popup -->
        <c:set var="userText" value="Here you can enter detailed 
        information for the current #{entityShortName}. The * marks the fields
        that have to be filled before you can proceed. Click on one of the buttons at the bottom 
        to perform the desired action." />
        
        
        <c:set var="technicalText" value="This is a 
        fully generic detail page for the entity '#{entityShortName}'.
        You can find its template in 'src/main/webapp/layout/detailView.xhtml'.
        Facelets templating is used to assemble the page based on some custom tags. 
        These are placed at 'src/main/webapp/WEB-INF/facelet' . In order to 
        perform CRUD (create, retrieve, update, delete) actions, a generic DAO 
        is used. For more information on how to retrieve generic DAOs, 
        see the package 'ch.elca.el4j.services.persistence.generic.dao.impl' in
        the sourcecode." />
    
    </ui:include>

	<h:form id="editForm">
		<rich:panel headerClass="topPanel">
			<f:facet name="header">#{title}</f:facet>

            <div align="right">
                <table border="0">
                    <tr>
                        <td>
					          <h:graphicImage value="img/help.png" style="cursor:pointer" 
					          onclick="Richfaces.showModalPanel('mp',{width:450, top:200})" />
	                   </td>
	                   <td>
					           <a style="vertical-align: center;" href="javascript:Richfaces.showModalPanel('mp',{width:450, top:200})">
					           About this page...</a>
					   </td>        
	               </tr>
	           </table>
	        </div>
            

			<ui:remove><!-- insert all fields --></ui:remove>
			<ui:insert name="fields">
				<el4j:fieldSet />
			</ui:insert>

			<div style="clear: both" />

			<p style="font-size: 10px">
				*) #{messages.RequiredFieldNote}
			</p>

			<ui:remove><!-- insert buttons (save, update, delete, cancel) --></ui:remove>
			<ui:insert name="crudBar">
				<el4j:crudBar masterPage="#{masterPage}" />
			</ui:insert>

		</rich:panel>

	</h:form>

</ui:composition>

