<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.ajax4jsf.org/rich"
	xmlns:el4j="http://www.elca.ch/el4j/taglib"
	template="layout/template.xhtml">
	
	<ui:remove><!-- a demo page showing various features --></ui:remove>

      

	<ui:remove><!-- demo 1 part 1: JavaScripts for Seam Remoting (AJAX) --></ui:remove>
	
	<!-- this is not needed since the popup is defined in the
	included masterView 
	<ui:include src="/WEB-INF/facelet/modalPanel.xhtml">
        
            
            <c:set var="panelTitle" value="Demos" />
        
        
            
            <c:set var="userText" value="TODO" />
            
            
            <c:set var="technicalText" value="TODO" />
             
    </ui:include>
    -->
	
	<ui:define name="JavaScripts">
		<s:remote include="remotingTest" />
		<script type="text/javascript">
//<![CDATA[
function sayHello() {
  var name = prompt("What is your name?");
  Seam.Component.getInstance("remotingTest").sayHello(name, sayHelloCallback);
}
function sayHelloCallback(result) {
  alert(result);
}
// ]]>
        </script>
	</ui:define>

	<ui:define name="body">
		<h:messages globalOnly="true" styleClass="message" />
		
		
            
         <div align="right">
                <table border="0">
                    <tr>
                        <td>
                              <h:graphicImage value="img/help.png" style="cursor:pointer" 
                              onclick="Richfaces.showModalPanel('mp',{width:450, top:200})" />
                       </td>
                       <td>
                               <a style="vertical-align: center;font-size:11px" href="javascript:Richfaces.showModalPanel('mp',{width:450, top:200})">
                               About this page...</a>
                       </td>        
                   </tr>
               </table>
         </div> 
		
		
		<h2>
			AJAX integration
		</h2>
		<button onclick="javascript:sayHello()">
			Say Hello
		</button>

		<ui:remove><!-- demo 2: Embed master view of entity containing a date field --></ui:remove>
		<h2>
			Entity Test
		</h2>
		<el4j:set var="entityShortName" value="entityTest" />
		<c:set var="detailPage" value="/entityTest.xhtml" />
		<ui:decorate template="layout/masterView.xhtml" />

		<ui:remove><!-- demo 3: Playground for conversations --></ui:remove>
		<h2>
			Conversation Playground
		</h2>
		<rich:panel>
			<f:facet name="header">Tests</f:facet>
			<h3>
				Actions
			</h3>
			<h:form>
				<ul>
					<li>
						<h:commandLink value="refresh"
							action="#{conversationTester.refresh()}" />
					</li>
					<li>
						<h:commandLink value="begin (no active conversation allowed)"
							action="#{conversationTester.begin()}" />
					</li>
					<li>
						<h:commandLink value="begin(join)"
							action="#{conversationTester.beginJoin()}" />
					</li>
					<li>
						<h:commandLink value="end" action="#{conversationTester.end()}" />
					</li>
				</ul>
			</h:form>
            Number of pages in conversation: #{counter}
            <h3>
				Conversations
			</h3>
			<h:dataTable
				value="#{org.jboss.seam.debug.contexts.conversationEntries}"
				rendered="#{not empty org.jboss.seam.debug.contexts.conversationEntries}"
				var="entry">
				<h:column>
					<f:facet name="header">conversation id</f:facet>
			        #{entry.id}
			    </h:column>
				<h:column>
					<f:facet name="header">activity</f:facet>
					<h:outputText value="#{entry.startDatetime}">
						<f:convertDateTime type="time" />
					</h:outputText>
			        - 
			        <h:outputText value="#{entry.lastDatetime}">
						<f:convertDateTime type="time" />
					</h:outputText>
				</h:column>
				<h:column>
					<f:facet name="header">description</f:facet>
			        #{entry.description}
			    </h:column>
				<h:column>
					<f:facet name="header">view id</f:facet>
			        #{entry.viewId}
			     </h:column>
				<h:column>
					<h:outputLink>
			          Select conversation context
			          <f:param
						  name="#{org.jboss.seam.core.manager.conversationIdParameter}"
						  value="#{entry.id}" />
					</h:outputLink>
				</h:column>
			</h:dataTable>
		</rich:panel>

	</ui:define>
</ui:composition>
